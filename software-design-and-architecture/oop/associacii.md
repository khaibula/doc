# Ассоциации

В объектно-ориентированном программировании (ООП) **ассоциация** — это общее понятие, обозначающее связь (relationship) между объектами или классами. Ассоциация описывает, «каким образом один объект знает о другом и может с ним взаимодействовать». При этом у нас могут быть разные типы ассоциаций, отражающие различный уровень связанности и «жизненного цикла» объектов.

Ниже разбираем основные виды ассоциаций, их назначение и приводим простые примеры.

***

### 1. Агрегация (Aggregation)

**Агрегация** — это частный случай ассоциации, когда один объект (контейнер, «whole») владеет ссылками на другие объекты (части, «parts»), но «части» могут существовать **отдельно** и без контейнера.

Признак агрегации:

* «Контейнер» может ссылаться на объекты, но их «жизненный цикл» не обязательно зависит от контейнера.
* Удаление «контейнера» не всегда влечёт автоматическое удаление «частей».

Например:

* **Класс «Команда»** (Team) и класс «Игрок»\*\* (Player). Игрок может существовать вне конкретной команды.
* **Класс «Город»** и класс «Житель»\*\*: житель может уехать в другой город, и объект «Город» от этого не разрушится.

#### Пример (агрегация «Команда» → «Игрок»):

```typescript
class Player {
  public name: string;

  constructor(name: string) {
    this.name = name;
  }
}

class Team {
  public name: string;
  private players: Player[] = [];

  constructor(name: string) {
    this.name = name;
  }

  public addPlayer(player: Player): void {
    this.players.push(player);
  }

  public listPlayers(): void {
    console.log(`Игроки команды ${this.name}:`);
    this.players.forEach((p) => console.log(p.name));
  }
}

function demoAggregation(): void {
  const player1 = new Player("Сергей");
  const player2 = new Player("Андрей");

  const team = new Team("Спартак");
  team.addPlayer(player1);
  team.addPlayer(player2);

  team.listPlayers();
  // Игроки не «исчезнут» при удалении team из памяти — 
  // если ссылки на них хранятся ещё где-то
}

demoAggregation();
```

* Игроки могут существовать независимо (например, сменить команду), это **агрегация**.

***

### 2. Композиция (Composition)

**Композиция** — более тесная форма связи, при которой «часть» (component) **не может** существовать **отдельно** от «целого» (composite). Жизненные циклы тесно связаны: если объект «целое» уничтожается, то и все его «части» тоже считаются уничтоженными.

Признак композиции:

* «Части» создаются и управляются внутри «целого», обычно не передаются «наружу» другим сущностям.
* «Части» не могут «пережить» уничтожение владельца.

Например:

* **Класс «Дом»** (House) и класс «Комната»\*\* (Room). Комнаты существуют только в доме, и при сносе дома комнаты исчезают.
* **Класс «Документ»** и класс «Страница»\*\*: страницы — часть документа, вне него они не имеют смысла (если задумка именно такая).

#### Пример (композиция «Дом» → «Комната»):

```typescript
class Room {
  private roomNumber: number;

  constructor(roomNumber: number) {
    this.roomNumber = roomNumber;
  }

  public getInfo(): string {
    return `Комната №${this.roomNumber}`;
  }
}

class House {
  private rooms: Room[] = [];

  constructor() {
    // Создаём комнаты внутри дома (композиция)
    this.rooms.push(new Room(1));
    this.rooms.push(new Room(2));
  }

  public listRooms(): void {
    console.log("Список комнат:");
    this.rooms.forEach((room) => console.log(room.getInfo()));
  }
}

function demoComposition(): void {
  const myHouse = new House();
  myHouse.listRooms();
  // При удалении объекта myHouse, комнаты "умрут" вместе с ним
}

demoComposition();
```

* **House** сам отвечает за создание и хранение **Room**. Комнаты не существуют отдельно, у них нет смысла вне этого дома. Это **композиция**.

***

### Итоговая сводка

1. **Агрегация (Aggregation)** — «has-a» (имеет) связь, где «части» могут жить автономно. Уничтожение контейнера не обязательно уничтожает части.
2. **Композиция (Composition)** — более строгая «has-a» связь, где «части» не могут существовать сами по себе и принадлежат исключительно «целому». При уничтожении «целого» уничтожаются и «части».

#### Применение в моделировании

* Если объекты должны существовать независимо, используем **агрегацию**.
* Если «части» полностью зависят от «целого» и не предполагается их «перемещение» куда-то ещё, это **композиция**.
* В реальных проектах важно правильно выбирать тип связи, чтобы грамотно отражать предметную область и жизненный цикл объектов.
